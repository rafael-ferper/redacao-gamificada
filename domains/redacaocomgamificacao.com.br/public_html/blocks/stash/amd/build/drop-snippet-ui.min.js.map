{"version":3,"sources":["../src/drop-snippet-ui.js"],"names":["define","$","UI","maker","container","_container","_maker","_init","prototype","_appearanceNode","_labelNode","_actionTextNode","_previewNode","_snippetNode","_actionTextZoneNode","_labelZoneNode","find","attr","getDefaultLabel","getDefaultActionText","setLabel","val","setDisplayType","setActionText","_updateForm","_setListeners","update","selector","change","e","currentTarget","bind","on","display","getDisplay","click","preventDefault","getSnippet","html","appearance","IMAGEANDBUTTON","hide","show","TEXT"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Drop snippet UI module.\n *\n * @package    block_stash\n * @copyright  2016 Frédéric Massart - FMCorz.net\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine([\n    'jquery',\n], function($) {\n\n    /**\n     * Snippet UI class.\n     *\n     * @param {DropSnippetMaker} maker The snippet maker.\n     * @param {Node} container The container of the UI.\n     */\n    function UI(maker, container) {\n        this._container = $(container);\n        this._maker = maker;\n        this._init();\n    }\n\n    UI.prototype._container = null;\n    UI.prototype._appearanceNode = null;\n    UI.prototype._labelNode = null;\n    UI.prototype._actionTextNode = null;\n    UI.prototype._previewNode = null;\n    UI.prototype._actionTextNode = null;\n    UI.prototype._snippetNode = null;\n\n    UI.prototype._actionTextZoneNode = null;\n    UI.prototype._labelZoneNode = null;\n\n    /**\n     * Initialise the things.\n     *\n     * @return {Void}\n     */\n    UI.prototype._init = function() {\n        this._appearanceNode = this.find('[name=displaytype]');\n        this._labelNode = this.find('[name=label]');\n        this._actionTextNode = this.find('[name=actiontext]');\n        this._snippetNode = this.find('[name=\"snippet\"]');\n        this._previewNode = this.find('.preview');\n\n        this._labelZoneNode = this.find('.snippet-label');\n        this._actionTextZoneNode = this.find('.snippet-actiontext');\n\n        // Set placeholders.\n        this._labelNode.attr('placeholder', this._maker.getDefaultLabel());\n        this._actionTextNode.attr('placeholder', this._maker.getDefaultActionText());\n\n        // Set form values.\n        this._maker.setLabel(this._labelNode.val());\n        this._maker.setDisplayType(this._appearanceNode.val());\n        this._maker.setActionText(this._actionTextNode.val());\n\n        this._updateForm();\n        this._setListeners();\n        this.update();\n    };\n\n    /**\n     * Find a node in this UI.\n     *\n     * @param {String} selector The selector.\n     * @return {Node}\n     */\n    UI.prototype.find = function(selector) {\n        return this._container.find(selector);\n    };\n\n    /**\n     * Set the event listeners.\n     *\n     * @return {Void}\n     */\n    UI.prototype._setListeners = function() {\n        this._appearanceNode.change(function(e) {\n            this._maker.setDisplayType($(e.currentTarget).val());\n            this._updateForm();\n            this.update();\n        }.bind(this));\n\n        this._labelNode.on('keyup', function(e) {\n            this._maker.setLabel($(e.currentTarget).val());\n            this._updateForm();\n            this.update();\n        }.bind(this));\n\n        this._actionTextNode.on('keyup', function(e) {\n            this._maker.setActionText($(e.currentTarget).val());\n            this._updateForm();\n            this.update();\n        }.bind(this));\n    };\n\n    /**\n     * Update the snippet and preview.\n     *\n     * @return {Void}\n     */\n    UI.prototype.update = function() {\n        var display = this._maker.getDisplay();\n\n        display.find('a, input').click(function(e) { e.preventDefault(); return; });\n\n        this._snippetNode.val(this._maker.getSnippet());\n        this._previewNode.html(display);\n    };\n\n    /**\n     * Update the form.\n     *\n     * @return {Void}\n     */\n    UI.prototype._updateForm = function() {\n        var appearance = this._appearanceNode.val();\n\n        if (appearance == this._maker.IMAGEANDBUTTON) {\n            this._labelZoneNode.hide();\n            this._actionTextZoneNode.show();\n\n        } else if (appearance == this._maker.TEXT) {\n            this._labelZoneNode.show();\n            this._actionTextZoneNode.hide();\n\n        } else {\n            this._labelZoneNode.hide();\n            this._actionTextZoneNode.hide();\n        }\n    };\n\n    return /** @alias module:block_stash/drop-snippet-ui */ UI;\n\n});\n"],"file":"drop-snippet-ui.min.js"}